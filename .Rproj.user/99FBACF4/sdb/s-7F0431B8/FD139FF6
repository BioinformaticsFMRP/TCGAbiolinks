{
    "contents" : "\\documentclass[a4paper]{article}\n\\title{Network inference Pan Cancer}\n\\author{A. Colaprico - L. Garofano}\n\\usepackage{longtable}\n\\begin{document}\n\\SweaveOpts{concordance=TRUE}\n\n\\maketitle\nIn this document we describe the workflow to perform Network inference in Pan Cancer.\n \n<< Finding data from TCGA,eval = FALSE, echo = FALSE >>=\nlibrary(RCurl)\nlibrary(EDASeq)\nsetwd(\"/storage/ocfs2_vol1/PUBLIC/\")\nsource('/storage/ocfs2_vol1/PUBLIC/LA_functions/DIFF_network_functions24.R')\nload(\"/storage/ocfs2_vol1/PUBLIC/LA_functions/geneInfo.RData\")\nlibrary(xlsx)\n\nsetwd(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_data/\")\nTCGA_Cancer_Types <- read.xlsx2(\"TCGA_Cancer_Types.xls\",1)\nTCGA_Cancer_Types <- as.data.frame(TCGA_Cancer_Types)\nTCGA_Cancer_Types[,1] <- as.character(TCGA_Cancer_Types[,1])\n\nPathFileTumor <- \"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_data/\"\nListofTumor <- sort(as.matrix(c(\"LGG\",\"BLCA\",\"BRCA\",\"COAD\",\"READ\",\"GBM\",\"HNSC\",\"KIRC\",\"LUAD\",\"OV\",\"UCEC\",\"CESC\",\"DLBC\",\"KICH\",\"KIRP\", \"LAML\",\"LIHC\",\"LUSC\", \"PAAD\", \"PRAD\",\"SARC\",\"SKCM\", \"UCS\",\"ACC\",\"MESO\",\"PCPG\")))\nPlatform_type <- \"rnaseqv2\"\n\nsetwd(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/\")\nTCGA_tumor_data <- FindingTCGAData(ListofTumor, tmpDir = PathFileTumor,verboseType= F)\nsave(TCGA_tumor_data, file =\"TCGA_tumor_data.RData\" )\n\n\nTCGA_tumor_data_rnaseqv2 <- TCGA_tumor_data[ TCGA_tumor_data$Platform %in% \"rnaseqv2\",]\nTCGA_tumor_data_rnaseqv2$Date <- substr(TCGA_tumor_data_rnaseqv2$Date,1,10)\nTableTumorTCGA_rnaseqv2 <- table(TCGA_tumor_data_rnaseqv2$Tumor , TCGA_tumor_data_rnaseqv2$Date)\n\nTableTumorTCGA_rnaseqv2 <- as.matrix(TableTumorTCGA_rnaseqv2)\n\n\nsetwd(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/\")\nload(\"TCGA_tumor_data.RData\")\ntable(TCGA_tumor_data[,\"Tumor\"]) \n\nlibrary(limma)\nfor( k in 1:nrow(ListofTumor)){\n  DownloadTumor_fromTCGA(TCGA_tumor_data,PathFileTumor,ListofTumor[k],Platform_type,newSamples=T)\n  FileManifest <- CreateFileManifest(PathFileTumor,ListofTumor[k],Platform_type,newSamples=T)\n  setwd(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/\")\n  save(FileManifest, file = paste(ListofTumor[k], \"_FileManifest.RData\",sep=\"\"))\n  print( paste( \"----------- Tumor n. \", k, \" of \",nrow(ListofTumor), \" ... \",  ListofTumor[k], \" completed.\"))\n}\n\n\n\n@\n\n<< Creating Analysis with matrix,eval = FALSE, echo = FALSE >>=\nlibrary(RCurl)\nlibrary(EDASeq)\n\nsetwd(\"/storage/ocfs2_vol1/PUBLIC/\")\nsource('/storage/ocfs2_vol1/PUBLIC/LA_functions/DIFF_network_functions24.R')\nload(\"/storage/ocfs2_vol1/PUBLIC/LA_functions/geneInfo.RData\")\n\n\nlibrary(xlsx)\nsetwd(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_data\")\nTCGA_Cancer_Types <- read.xlsx2(\"TCGA_Cancer_Types.xls\",1)\nTCGA_Cancer_Types <- as.data.frame(TCGA_Cancer_Types)\nTCGA_Cancer_Types[,1] <- as.character(TCGA_Cancer_Types[,1])\n\nPathFileTumor <- \"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_data/\"\n#ListofTumor <- as.matrix(c(\"LGG\",\"BLCA\",\"BRCA\",\"COAD\",\"READ\",\"GBM\",\"HNSC\",\"KIRC\",\"LUAD\",\"OV\",\"UCEC\",\"CESC\",\"DLBC\",\"KICH\",\"KIRP\", \"LAML\",\"LIHC\",\"LUSC\", \"PAAD\", \"PRAD\",\"SARC\",\"SKCM\", \"UCS\",\"LAML\",\"ACC\",\"CESC\",\"MESO\",\"PCPG\"))\n\n#ListofTumor <- as.matrix(c(\"LGG\",\"BLCA\",\"BRCA\",\"COAD\",\"READ\",\"GBM\",\"HNSC\",\"KIRC\",\"LUAD\",\"OV\",\"UCEC\",\"CESC\",\"DLBC\",\"KICH\",\"KIRP\", \"LAML\",\"LIHC\",\"LUSC\", \"PAAD\", \"PRAD\",\"SARC\",\"SKCM\", \"UCS\",\"LAML\",\"ACC\",\"CESC\",\"MESO\",\"PCPG\"))\n\nListofTumor <- as.matrix( sort(c(\"SARC\",\"SKCM\",\"UCS\")))\n\nPlatform_type <- \"rnaseqv2\"\n\nsetwd(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/\")\nPlatform_type <- \"rnaseqv2\"\nPathFileTumor <- \"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_data/\"\n\nIPA_genes_dataset_summary <- read.delim(\"/storage/ocfs2_vol1/PUBLIC/LA_functions/IPA_genes_dataset_summary.txt\",stringsAsFactors = F)\nIPA_transcription_factors <- IPA_genes_dataset_summary[IPA_genes_dataset_summary$Family == \"transcription regulator\",]\n\n\nfor ( y in 1:nrow(ListofTumor)){\n  setwd(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer\")\n  filetoLoad <- paste(ListofTumor[y], \"_FileManifest.RData\",sep=\"\")\n  filetoSave <- paste(ListofTumor[y], \"_Analysis.RData\",sep=\"\")\n  load(filetoLoad)\n  \n  NametumorPubmed  <- TCGA_Cancer_Types[grep(ListofTumor[y], TCGA_Cancer_Types[,1]),1]\n  NametumorPubmed <- tolower(as.matrix(unlist(strsplit(NametumorPubmed,\" \")))[1])\n  \n  if(NametumorPubmed == \"brain\"){   NametumorPubmed <- \"glioma\"  }\n  if(NametumorPubmed == \"acute\"){   NametumorPubmed <- \"leukemia\"  }\n  if(ListofTumor[y] == \"MESO\"){   NametumorPubmed <- \"mesothelioma\"  }\n  if(ListofTumor[y] == \"SARC\"){   NametumorPubmed <- \"sarcoma\"  }\n  \n  Cancer_analysis <- CancerAnalysisTCGA(PathFileTumor,ListofTumor[y],Platform_type,FileManifest,NametumorPubmed,IPA_transcription_factors)\n  setwd(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_Analysis\")\n  save(Cancer_analysis, file = filetoSave )\n  print( paste( \"----------- Tumor n. \", y, \" of \",nrow(ListofTumor), \" ... \",  ListofTumor[y],\" with name pubmed \", NametumorPubmed, \" completed.\"))\n  \n}\n\n\n@\n\n<< results = tex, echo = FALSE>>=\nload(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_tumor_data.RData\")\nsource('/storage/ocfs2_vol1/PUBLIC/LA_functions/DIFF_network_functions24.R')\nsetwd(\"/storage/ocfs2_vol1/PUBLIC/LA_functions/\")\nlibrary(xlsx)\nsetwd(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_data\")\nTCGA_Cancer_Types <- read.xlsx2(\"TCGA_Cancer_Types.xls\",1)\nTCGA_Cancer_Types <- as.data.frame(TCGA_Cancer_Types)\nTCGA_Cancer_Types[,1] <- as.character(TCGA_Cancer_Types[,1])\nTCGA_tumor_data <- as.data.frame( TCGA_tumor_data)\n\nTableTumorTCGA <- table(TCGA_tumor_data$Tumor , TCGA_tumor_data$Platform)\nTableTumorTCGA <- as.matrix(TableTumorTCGA)\n\ncolnames(TableTumorTCGA)<-c(\"rnaseq\", \"rnaseqv2\",\"totalrnaseqv2\")\nCancerType <- matrix(0, nrow(TableTumorTCGA),1)\nTableTumorTCGA <- cbind(CancerType,TableTumorTCGA)\ncolnames(TableTumorTCGA)<-c(\"CancerType\",\"rnaseq\", \"rnaseqv2\",\"totalrnaseqv2\")\nTableTumorTCGA <- as.matrix(TableTumorTCGA)\n  for( k in 1:nrow(TableTumorTCGA)){\n    currentTumor <- rownames(TableTumorTCGA)[k]\n    tmp <- TCGA_Cancer_Types$Available.Cancer.Types [grep( currentTumor, TCGA_Cancer_Types$Available.Cancer.Types )]\n  TableTumorTCGA[k,\"CancerType\"] <- as.character(tmp)\n  \n  }\n\nTableTumorTCGA <- as.data.frame(TableTumorTCGA)\n\nTableTumorTCGA$rnaseq <- as.numeric(as.character(TableTumorTCGA$rnaseq))\nTableTumorTCGA$rnaseqv2 <- as.numeric(as.character(TableTumorTCGA$rnaseqv2))\nTableTumorTCGA$totalrnaseqv2 <- as.numeric(as.character(TableTumorTCGA$totalrnaseqv2))\n\n\n setwd(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_data\")\nsave(TableTumorTCGA, file = \"TableTumorTCGA.RData\" )\n\nLatexPrintTableforPresentation (TableTumorTCGA,nrow(TableTumorTCGA),TableTitle=\"TCGA Data tumor used\",LabelTitle=\"TCGA Data tumor used\",withrows= T)\n\n\nTCGA_tumor_data_rnaseqv2 <- TCGA_tumor_data[ TCGA_tumor_data$Platform %in% \"rnaseqv2\",]\nTCGA_tumor_data_rnaseqv2$Date <- substr(TCGA_tumor_data_rnaseqv2$Date,1,10)\nTableTumorTCGA_rnaseqv2 <- table(TCGA_tumor_data_rnaseqv2$Tumor , TCGA_tumor_data_rnaseqv2$Date)\n\nTableTumorTCGA_rnaseqv2 <- as.matrix(TableTumorTCGA_rnaseqv2)\nLatexPrintTableforPresentation (TableTumorTCGA_rnaseqv2,nrow(TableTumorTCGA_rnaseqv2),TableTitle=\"TCGA Number of Sample (rnaseqv2) of each Tumor with date\",LabelTitle=\"TCGA Number of Sample (rnaseqv2) of each Tumor with date\",withrows= T)\n@\n\n<< STEP results , eval=TRUE, echo=FALSE >>=\nload(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_tumor_data.RData\")\nload(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_data/TCGA_tumor_data.RData\")\nTCGA_tumor_data <- as.data.frame(TCGA_tumor_data)\n@\n\n\\section{Data preparation}\n\nFrom TCGA, we collected expression data on both mRNA and miRNA samples over COAD cancer types (TCGA public data until July 10, 2014).\n\nFrom TCGA, we collected expression data on  \\Sexpr{nrow(TCGA_tumor_data)} samples over   \\Sexpr{length(unique(TCGA_tumor_data$Tumor))}  cancer types (TCGA public data until July 10, 2014). Out of \\Sexpr{nrow(TCGA_tumor_data)} samples, \\Sexpr{as.numeric(table(TCGA_tumor_data$Platform)[\"rnaseq\"])} were expression profiled using RNAseq, \\Sexpr{as.numeric(table(TCGA_tumor_data$Platform)[\"rnaseqv2\"])} were expression profiled using RNAseqv2, and \\Sexpr{as.numeric(table(TCGA_tumor_data$Platform)[\"totalrnaseqv2\"])} were expression profiled using totalrnaseqv2. \n\n<< Making tex of table pubmed , eval = FALSE, echo = FALSE >>=\nload(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_tumor_data.RData\")\n\nTCGA_tumor_data <- as.data.frame(TCGA_tumor_data)\n\nTCGA_tumor_data_rnaseqv2 <- TCGA_tumor_data[TCGA_tumor_data$Platform  == \"rnaseqv2\",]\nBarcode <- matrix(0,nrow(TCGA_tumor_data_rnaseqv2),1)\nSample <- matrix(0,nrow(TCGA_tumor_data_rnaseqv2),1)\nTCGA_tumor_data_rnaseqv2 <- cbind(Sample,Barcode,TCGA_tumor_data_rnaseqv2)\n\n\n  setwd(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer\")\n  filetoLoad <- paste(ListofTumor[y], \"_FileManifest.RData\",sep=\"\")\n\n\n\nfor ( y in 1: nrow(ListofTumor)){\n  CurrentTumor <- ListofTumor[y]\n  filetoLoad <- paste(ListofTumor[y], \"_FileManifest.RData\",sep=\"\")\n  load(filetoLoad)\n  print ( paste(filetoLoad, \"...ok\"))\n  \n  for ( k in 1:nrow(FileManifest)){\n  FileManifest$FileName[1]\n  sample <-grep(gsub(\".txt\",\"\",FileManifest$FileName[k]), TCGA_tumor_data_rnaseqv2$URL)\n  TCGA_tumor_data_rnaseqv2[sample,\"Barcode\"] <- FileManifest$Barcode[k]\n    }\n}\n\n\n\n\n   TCGA_tumor_data_rnaseqv2[which( as.numeric(substr(TCGA_tumor_data_rnaseqv2[,\"Barcode\"], 14, 15)) < 10),\"Sample\"] <- \"Tumor\"\n   TCGA_tumor_data_rnaseqv2[which( as.numeric(substr(TCGA_tumor_data_rnaseqv2[,\"Barcode\"], 14, 15)) >=10),\"Sample\"] <- \"Normal\"\n  TCGA_tumor_data_rnaseqv2[which( TCGA_tumor_data_rnaseqv2[,\"Barcode\"] ==0) ,\"Sample\"] <- \"Tumor\"\n\nTCGA_tumor_data_rnaseqv2_sample <- table(TCGA_tumor_data_rnaseqv2$Tumor ,TCGA_tumor_data_rnaseqv2$Sample)\nTCGA_tumor_data_rnaseqv2_sample <-as.matrix(TCGA_tumor_data_rnaseqv2_sample)\n\nPerc <- matrix(0,nrow(TCGA_tumor_data_rnaseqv2_sample),1)\nTCGA_tumor_data_rnaseqv2_sample <- cbind(TCGA_tumor_data_rnaseqv2_sample,Perc)\ncolnames(TCGA_tumor_data_rnaseqv2_sample) <- c(\"Normal\",\"Tumor\",\"Perc\")\nTCGA_tumor_data_rnaseqv2_sample <-as.data.frame(TCGA_tumor_data_rnaseqv2_sample)\nTCGA_tumor_data_rnaseqv2_sample[,\"Perc\"] <- round(TCGA_tumor_data_rnaseqv2_sample[,\"Normal\"] / TCGA_tumor_data_rnaseqv2_sample[,\"Tumor\"],4)\nTCGA_tumor_data_rnaseqv2_sample <- TCGA_tumor_data_rnaseqv2_sample[order(TCGA_tumor_data_rnaseqv2_sample$Perc,decreasing=T),]\n\nLatexPrintTableforPresentation (TCGA_tumor_data_rnaseqv2_sample,nrow(TCGA_tumor_data_rnaseqv2_sample),TableTitle=\"a\",LabelTitle=\"a\",withrows= T)\n\nsave(TCGA_tumor_data_rnaseqv2_sample, file =\"TCGA_tumor_data_rnaseqv2_sample.RData\")\n\n#PathFileTumor<- \"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_data/\"\n# DownloadTumor_fromTCGA(TCGA_tumor_data,PathFileTumor,\"BLCA\",Platform_type)\n# CreateFileManifest(PathFileTumor,\"BLCA\",\"rnaseqv2\")\n# CreateFileManifest <- function(PathFile,TumorName,Tecnology)\n  \n\n\n\n@\n\n<< results = tex, echo = FALSE>>=\nload(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_tumor_data_rnaseqv2_sample.RData\")\n\nLatexPrintTableforPresentation (TCGA_tumor_data_rnaseqv2_sample,nrow(TCGA_tumor_data_rnaseqv2_sample),TableTitle=\"a\",LabelTitle=\"a\",withrows= T)\n\nPathFileAnalysis <- \"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_Analysis/\"\nsetwd(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_data\")\nTCGA_Cancer_Types <- read.xlsx2(\"TCGA_Cancer_Types.xls\",1)\nTCGA_Cancer_Types <- as.data.frame(TCGA_Cancer_Types)\nTCGA_Cancer_Types[,1] <- as.character(TCGA_Cancer_Types[,1])\n\nsetwd(\"/storage/ocfs2_vol1/PUBLIC/LA_functions\")\nPanCancer_TF_validated_target <- as.data.frame(read.xlsx2(\"PanCancer_TF_validated_target.xlsx\",2))\nTCGA_cancer_in_cell_lines <- gsub(\" \",\"\",as.matrix(unique(unlist(strsplit(as.character(PanCancer_TF_validated_target$TCGA.Cancer),\",\")))))\n\nsource('/storage/ocfs2_vol1/PUBLIC/LA_functions/DIFF_network_functions24.R')\nload(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_tumor_data_rnaseqv2_sample.RData\")\nTCGA_tumor_data_rnaseqv2_sample_onlyDEA <- TCGA_tumor_data_rnaseqv2_sample[TCGA_tumor_data_rnaseqv2_sample$Perc >= 0.05,]\nListofTumor <- as.matrix(rownames(TCGA_tumor_data_rnaseqv2_sample_onlyDEA ))\n\nListofTumor <- as.matrix(intersect(ListofTumor,TCGA_cancer_in_cell_lines) )\nPlatform_type <- \"rnaseqv2\"\nsetwd(PathFileAnalysis)\n\nCancerPubmed_complete <- NULL\n\nfor ( y in 1: nrow(ListofTumor)){\n  CurrentTumor <- ListofTumor[y]\n  filetoLoad <- paste(ListofTumor[y], \"_Analysis.RData\",sep=\"\")\n  load(filetoLoad)\n  CancerPubmed <- Cancer_analysis$CANCER_diff_normUQ_level_tf_pubmed\n \n  CancerPubmed <- CancerPubmed[order(CancerPubmed$Pubmed,decreasing=T),]\n  CancerPubmed$FDR <- format(CancerPubmed$FDR,digits=3)\n  message ( paste(filetoLoad, \"...ok\"))\n  #print(CancerPubmed[1:20,])\n\n  NametumorPubmed  <- TCGA_Cancer_Types[grep(ListofTumor[y], TCGA_Cancer_Types[,1]),1]\n  NametumorPubmed <- tolower(as.matrix(unlist(strsplit(NametumorPubmed,\" \")))[1])\n  \n  CancerPubmed_new <- cbind( Cancer = rep(NametumorPubmed,20), CancerTCGA = rep(CurrentTumor,20), CancerPubmed[1:20,])\n  CancerPubmed_complete <- rbind(CancerPubmed_complete,CancerPubmed_new)\n  \nLatexPrintTableforPresentation(CancerPubmed[1:20,], rowsForPage = 20, TableTitle = paste(CurrentTumor,\" DEA genes and pubmed\",sep=\"\"), LabelTitle = paste(CurrentTumor,\"DEA genes and pubmed\",sep=\"\"), withrows = F)\n}\n\nsetwd(PathFileAnalysis)\nsave( CancerPubmed_complete, file =\"CancerPubmed_complete.RData\")\n\n\nCancerPubmed_complete$Cancer <- as.character(CancerPubmed_complete$Cancer)\nTF_forIPA <- as.matrix(unique(CancerPubmed_complete$mRNA))\nTF_forIPA <- cbind(TF_forIPA , matrix(0,nrow(TF_forIPA),2))\nTF_forIPA <-as.data.frame(TF_forIPA)\ncolnames(TF_forIPA) <- c(\"TF\",\"Num\",\"Cancers\")\nTF_forIPA$TF <- as.character(TF_forIPA$TF)\nTF_forIPA$Num <- as.numeric(TF_forIPA$Num)\nTF_forIPA$Cancers <- as.character(TF_forIPA$Cancers)\n\n\nfor ( i in 1: nrow(TF_forIPA)){\n  \n  currentTF <- as.character(TF_forIPA$TF[i])\n  tmp <- as.matrix(CancerPubmed_complete[CancerPubmed_complete$mRNA == currentTF, ])\n  TF_forIPA[i,\"Num\"] <- length(unique(tmp[,\"Cancer\"]))\n  TF_forIPA[i,\"Cancers\"] <- paste(unique(tmp[,\"Cancer\"]),collapse=\"; \")\n}\n\nTF_forIPA <- TF_forIPA[order(TF_forIPA$Num,decreasing=T),]\n\nLatexPrintTableforPresentation(TF_forIPA[1:50,], rowsForPage = 50, TableTitle = \"TFs for IPA\", LabelTitle = \"TFs for IPA\", withrows = F)\n\n@\n\n<< results = tex, echo = FALSE >>= \n#IPA Cancer cell lines TF validated Target\n\nsource('/storage/ocfs2_vol1/PUBLIC/LA_functions/DIFF_network_functions24.R')\nsetwd(\"/storage/ocfs2_vol1/PUBLIC/LA_functions\")\nPanCancer_TF_validated_target <- as.data.frame(read.xlsx2(\"PanCancer_TF_validated_target.xlsx\",2))\n\n\nTCGA_cancer_in_cell_lines <- gsub(\" \",\"\",as.matrix(unique(unlist(strsplit(as.character(PanCancer_TF_validated_target$TCGA.Cancer),\",\")))))\n\nLatexPrintTableforPresentation(PanCancer_TF_validated_target, rowsForPage =nrow(PanCancer_TF_validated_target), TableTitle = \"IPA Cancer Cell Lines\", LabelTitle = \"IPA Cancer Cell Lines\", withrows = F)\nsetwd(\"/storage/ocfs2_vol1/PUBLIC/LA_functions\")\n@\n\n<< Luc results,eval = FALSE, echo = FALSE >>=\nsetwd(\"/storage/ocfs2_vol1/PUBLIC/LA_functions\")\nPanCancer_TF_validated_target <- as.data.frame(read.xlsx2(\"PanCancer_TF_validated_target.xlsx\",2))\nTCGA_cancer_in_cell_lines <- gsub(\" \",\"\",as.matrix(unique(unlist(strsplit(as.character(PanCancer_TF_validated_target$TCGA.Cancer),\",\")))))\n\nload(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_tumor_data_rnaseqv2_sample.RData\")\nTCGA_tumor_data_rnaseqv2_sample_onlyDEA <- TCGA_tumor_data_rnaseqv2_sample[TCGA_tumor_data_rnaseqv2_sample$Perc >= 0.05,]\nListofTumor <- as.matrix(rownames(TCGA_tumor_data_rnaseqv2_sample_onlyDEA ))\nListofTumor <- as.matrix(intersect(ListofTumor,TCGA_cancer_in_cell_lines) )\nsave(ListofTumor, file = \"/storage/ocfs2_vol1/PUBLIC/LA_functions/ListofTumor.RData\")\n\n\nsetwd(\"/storage/ocfs2_vol1/PUBLIC/LA_functions/\")\nsource(\"DIFF_network_functions24.R\")\nload(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_Analysis/CancerPubmed_complete.RData\")\nload(\"/storage/ocfs2_vol1/PUBLIC/LA_functions/ListofTumor.RData\")\nListofTumor <- as.vector(sort(ListofTumor))\nCancer_knnNet <- knnNet(ListofTumor[1], k = 3, nboot = 100, nGenesPerm = 1000, analysisPath = \"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_Analysis/\",TFlistDefined=)\nsetwd(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_Networks\")\nsave(Cancer_knnNet, file = \"BRCA_knnNet.RData\")\n\nload(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_Analysis/BRCA_Analysis.RData\")\ngeneList <- rownames(Cancer_analysis$Data_CANCER_normUQ_filt)\nsave(geneList, file = \"/storage/ocfs2_vol1/PUBLIC/LA_functions/geneList.RData\")\n\nsetwd(\"/storage/ocfs2_vol1/PUBLIC/LA_functions\")\n\n\n\nsetwd(\"/storage/ocfs2_vol1/PUBLIC/LA_functions/\")\nsource(\"DIFF_network_functions24.R\")\nload(\"/storage/ocfs2_vol1/PUBLIC/LA_functions/geneList.RData\")\nload(\"/storage/ocfs2_vol1/PUBLIC/LA_functions/ListofTumor.RData\")\nListofTumor <- as.vector(sort(ListofTumor))\nCancer_IPANet <- IPANet(TumorName = ListofTumor[1], genesToConsider = geneList, IPAfilesPath = \"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TFs_target_validated/\")\nsave(Cancer_IPANet, file = paste(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_Networks/\", ListofTumor[1], \"_IPANet.RData\", sep = \"\"))\n\n\n\n@\n\n<< Complete network, eval =FALSE, echo =FALSE >>=\nload(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_Networks/BRCA_IPANet.RData\")\ntfList <- unique(Cancer_IPANet$complete$from)\n\nListofTumor <- as.matrix(c(\"LGG\",\"BLCA\",\"BRCA\",\"COAD\",\"READ\",\"GBM\",\"HNSC\",\"KIRC\",\"LUAD\",\"OV\",\"UCEC\",\"CESC\",\"DLBC\",\"KICH\",\"KIRP\", \"LAML\",\"LIHC\",\"LUSC\", \"PAAD\", \"PRAD\",\"SARC\",\"SKCM\", \"UCS\",\"LAML\",\"ACC\",\"CESC\",\"MESO\",\"PCPG\"))\n\n\nsetwd(\"/storage/ocfs2_vol1/PUBLIC/LA_functions/\")\nsource(\"DIFF_network_functions24.R\")\nload(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_Analysis/CancerPubmed_complete.RData\")\nload(\"/storage/ocfs2_vol1/PUBLIC/LA_functions/ListofTumor.RData\")\n\nListofTumor <- as.matrix(c(\"LGG\",\"BLCA\",\"BRCA\",\"COAD\",\"READ\",\"GBM\",\"HNSC\",\"KIRC\",\"LUAD\",\"OV\",\"UCEC\",\"CESC\",\"DLBC\",\"KICH\",\"KIRP\", \"LAML\",\"LIHC\",\"LUSC\", \"PAAD\", \"PRAD\",\"SARC\",\"SKCM\", \"UCS\",\"LAML\",\"ACC\",\"CESC\",\"MESO\",\"PCPG\"))\n\nListofTumor <- as.vector(sort(ListofTumor))\n\nfor ( i in 1: length(ListofTumor)){\nCancer_knnNet <- knnNet(ListofTumor[i], k = 3, nboot = 100, nGenesPerm = 1000, analysisPath = \"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_Analysis/\",TFlistDefined=tfList)\nsetwd(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_Networks\")\nsave(Cancer_knnNet, file = paste(ListofTumor[i],\"_knnNet.RData\",sep=\"\"))\n\n  print( paste( \"----------- Tumor n. \", i, \" of \",length(ListofTumor), \" ... \",  ListofTumor[i], \" completed.\"))\n}\n\n@\n\n<< Performance evaluation , eval=FALSE, echo=FALSE >>=\nload(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_Networks/BRCA_IPANet.RData\")\nsource('/storage/ocfs2_vol1/PUBLIC/LA_functions/DIFF_network_functions24.R')\nload(\"/storage/ocfs2_vol1/PUBLIC/LA_functions/ListofTumor.RData\")\n\nListofTumor <- as.matrix(unique(c(\"LGG\",\"BLCA\",\"BRCA\",\"COAD\",\"READ\",\"GBM\",\"HNSC\",\"KIRC\",\"LUAD\",\"OV\",\"UCEC\",\"CESC\",\"DLBC\",\"KICH\",\"KIRP\", \"LAML\",\"LIHC\",\"LUSC\", \"PAAD\", \"PRAD\",\"SARC\", \"UCS\",\"LAML\",\"ACC\",\"CESC\",\"MESO\",\"PCPG\")))\n\nListofTumor <- as.vector(sort(ListofTumor))\nload(\"/storage/ocfs2_vol1/PUBLIC/LA_functions/geneList.RData\")\n\n\nPerformance_matrix <- NULL\nfor ( i in 1: length(ListofTumor)){\n  fileToLoad <- paste(ListofTumor[i],\"_knnNet.RData\",sep=\"\")\n  load(fileToLoad)\n  Cancer_knnNet$Net <- cbind(Pairs = paste( Cancer_knnNet$Net[,\"from\"], Cancer_knnNet$Net[,\"to\"], sep=\",\"),Cancer_knnNet$Net)\n  tmp <- PerformanceNET(PredictedNET = Cancer_knnNet$Net,ValidatedNET = Cancer_IPANet$complete, geneList)\n  Performance_matrix <- rbind(Performance_matrix, tmp)\n}\nrownames(Performance_matrix) <- ListofTumor\n  \n\nLatexPrintTableforPresentation(Performance_matrix, rowsForPage=nrow(Performance_matrix),TableTitle=\"p\" , LabelTitle=\"p\",withrows= T )\n\nload(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_Networks/BRCA_knnNet.RData\")\nCancer_knnNet$Net <- cbind(Pairs = paste( Cancer_knnNet$Net[,\"from\"], Cancer_knnNet$Net[,\"to\"], sep=\",\"),Cancer_knnNet$Net)\n\n\ntmp1 <- PerformanceNET(PredictedNET = Cancer_knnNet$Net,ValidatedNET = Cancer_IPANet$strong, geneList)\ntmp2 <- PerformanceNET(PredictedNET = Cancer_knnNet$Net,ValidatedNET = Cancer_IPANet$weak, geneList)\ntmp3 <- PerformanceNET(PredictedNET = Cancer_knnNet$Net,ValidatedNET = Cancer_IPANet$complete, geneList)\n  Performance_matrix_BRCA <- rbind(tmp1, tmp2,tmp3)\nrownames(Performance_matrix_BRCA) <- c(\"strong\",\"weak\",\"complete\")\n\n\n\nLatexPrintTableforPresentation(Performance_matrix_BRCA, rowsForPage=nrow(Performance_matrix_BRCA),TableTitle=\"p\" , LabelTitle=\"p\",withrows= T )\n\nlibrary(randomForest)\nsource('/storage/ocfs2_vol1/PUBLIC/LA_functions/genie3.R')\nload(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_Analysis/BRCA_Analysis.RData\")\n\n#BRCA_genie3 <- Genie3Net(Cancer_analysis$Data_CANCER_normUQ_filt, tfList)\n\n                                   \n\n@\n\n<< Network with othere methods, eval=FALSE, echo=FALSE >>=\nlibrary(RTN)\nlibrary(snow)\nsource('/storage/ocfs2_vol1/PUBLIC/LA_functions/DIFF_network_functions24.R')\nload(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_Networks/BRCA_IPANet.RData\")\ntfList <- unique(Cancer_IPANet$complete$from)\n\nsetwd(\"/storage/ocfs2_vol1/PUBLIC/LA_functions/\")\nsource(\"DIFF_network_functions24.R\")\nload(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_Analysis/CancerPubmed_complete.RData\")\nload(\"/storage/ocfs2_vol1/PUBLIC/LA_functions/ListofTumor.RData\")\n\nListofTumor <- as.matrix(c(\"LGG\",\"BLCA\",\"BRCA\",\"COAD\",\"READ\",\"GBM\",\"HNSC\",\"KIRC\",\"LUAD\",\"OV\",\"UCEC\",\"CESC\",\"DLBC\",\"KICH\",\"KIRP\", \"LAML\",\"LIHC\",\"LUSC\", \"PAAD\", \"PRAD\",\"SARC\",\"UCS\",\"LAML\",\"ACC\",\"CESC\",\"MESO\",\"PCPG\"))\n\nListofTumor <- as.vector(sort(ListofTumor))\n\nfor ( i in 27: length(ListofTumor)){\n  setwd(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_Analysis\")\n  fileToLoad <- paste(ListofTumor[i],\"_Analysis.RData\",sep=\"\")\n  load(fileToLoad)\n  \n  normCounts <- Cancer_analysis$Data_CANCER_normUQ_filt\n  Cancer_CorNet<-CreateCorNetwork(tfList,normCounts,ncpu=60)\n  \n   setwd(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_Networks/RTN_Network\")\n   save(Cancer_CorNet, file = paste(ListofTumor[i],\"_CorNet.RData\",sep=\"\"))\n\n  print( paste( \"----------- Tumor n. \", i, \" of \",length(ListofTumor), \" ... \",  ListofTumor[i], \" completed.\"))\n}\n\n\n\n\n\n\n\n\n\n@\n\n<< Performance on correlation , echo=FALSE, eval=FALSE >>=\nload(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_Networks/BRCA_IPANet.RData\")\nsource('/storage/ocfs2_vol1/PUBLIC/LA_functions/DIFF_network_functions24.R')\nload(\"/storage/ocfs2_vol1/PUBLIC/LA_functions/ListofTumor.RData\")\nsetwd(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_Networks/RTN_Network\")\n\nListofTumor <- as.matrix(unique(c(\"LGG\",\"BLCA\",\"BRCA\",\"COAD\",\"READ\",\"GBM\",\"HNSC\",\"KIRC\",\"LUAD\",\"OV\",\"UCEC\",\"CESC\",\"DLBC\",\"KICH\",\"KIRP\", \"LAML\",\"LIHC\",\"LUSC\", \"PAAD\", \"PRAD\",\"SARC\", \"UCS\",\"LAML\",\"ACC\",\"CESC\",\"MESO\",\"PCPG\")))\n\nListofTumor <- as.vector(sort(ListofTumor))\nload(\"/storage/ocfs2_vol1/PUBLIC/LA_functions/geneList.RData\")\n\nPerformance_matrix <- NULL\nfor ( i in 1: length(ListofTumor)){\n  fileToLoad <- paste(ListofTumor[i],\"_CorNet.RData\",sep=\"\")\n  load(fileToLoad)\n  Network_rntiDpi <- t(Cancer_CorNet$rtniDpi@results$tn.dpi)\n  Network_rntiDpi_cyt <- ConvertCor_to_Cytoscape_onlyNet(Network_rntiDpi,outPrint=T)\n  tmp <- PerformanceNET(PredictedNET = Network_rntiDpi_cyt,ValidatedNET = Cancer_IPANet$complete, geneList)\n  Performance_matrix <- rbind(Performance_matrix, tmp)\n}\nrownames(Performance_matrix) <- ListofTumor\n\nLatexPrintTableforPresentation(Performance_matrix, rowsForPage=nrow(Performance_matrix),TableTitle=\"p\" , LabelTitle=\"p\",withrows= T )\n\nload(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_Networks/RTN_Network/BRCA_CorNet.RData\")\nNetwork_rntiDpi <- t(Cancer_CorNet$rtniDpi@results$tn.dpi)\nNetwork_rntiDpi_cyt <- ConvertCor_to_Cytoscape_onlyNet(Network_rntiDpi,outPrint=T)\ntmp1 <- PerformanceNET(PredictedNET = Network_rntiDpi_cyt,ValidatedNET = Cancer_IPANet$strong, geneList)\ntmp2 <- PerformanceNET(PredictedNET = Network_rntiDpi_cyt,ValidatedNET = Cancer_IPANet$weak, geneList)\ntmp3 <- PerformanceNET(PredictedNET = Network_rntiDpi_cyt,ValidatedNET = Cancer_IPANet$complete, geneList)\nPerformance_matrix_BRCA <- rbind(tmp1, tmp2,tmp3)\nrownames(Performance_matrix_BRCA) <- c(\"strong\",\"weak\",\"complete\")\n\nLatexPrintTableforPresentation(Performance_matrix_BRCA, rowsForPage=nrow(Performance_matrix_BRCA),TableTitle=\"p\" , LabelTitle=\"p\",withrows= T )\n\n\n\n# correlation with ref\nload(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_Networks/BRCA_IPANet.RData\")\nsource('/storage/ocfs2_vol1/PUBLIC/LA_functions/DIFF_network_functions24.R')\nload(\"/storage/ocfs2_vol1/PUBLIC/LA_functions/ListofTumor.RData\")\nsetwd(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_Networks/RTN_Network\")\n\nListofTumor <- as.matrix(unique(c(\"LGG\",\"BLCA\",\"BRCA\",\"COAD\",\"READ\",\"GBM\",\"HNSC\",\"KIRC\",\"LUAD\",\"OV\",\"UCEC\",\"CESC\",\"DLBC\",\"KICH\",\"KIRP\", \"LAML\",\"LIHC\",\"LUSC\", \"PAAD\", \"PRAD\",\"SARC\", \"UCS\",\"LAML\",\"ACC\",\"CESC\",\"MESO\",\"PCPG\")))\n\nListofTumor <- as.vector(sort(ListofTumor))\nload(\"/storage/ocfs2_vol1/PUBLIC/LA_functions/geneList.RData\")\n\nPerformance_matrix <- NULL\nfor ( i in 1: length(ListofTumor)){\n  fileToLoad <- paste(ListofTumor[i],\"_CorNet.RData\",sep=\"\")\n  load(fileToLoad)\n  Network_rntiref <- t(Cancer_CorNet$rtniDpi@results$tn.ref)\n  Network_rntiref_cyt <- ConvertCor_to_Cytoscape_onlyNet(Network_rntiref,outPrint=T)\n  tmp <- PerformanceNET(PredictedNET = Network_rntiref_cyt,ValidatedNET = Cancer_IPANet$complete, geneList)\n  Performance_matrix <- rbind(Performance_matrix, tmp)\n}\nrownames(Performance_matrix) <- ListofTumor\n\nLatexPrintTableforPresentation(Performance_matrix, rowsForPage=nrow(Performance_matrix),TableTitle=\"p\" , LabelTitle=\"p\",withrows= T )\n\nload(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_Networks/RTN_Network/BRCA_CorNet.RData\")\nNetwork_rntiref <- t(Cancer_CorNet$rtniDpi@results$tn.ref)\nNetwork_rntiref_cyt <- ConvertCor_to_Cytoscape_onlyNet(Network_rntiref,outPrint=T)\ntmp1 <- PerformanceNET(PredictedNET = Network_rntiref_cyt,ValidatedNET = Cancer_IPANet$strong, geneList)\ntmp2 <- PerformanceNET(PredictedNET = Network_rntiref_cyt,ValidatedNET = Cancer_IPANet$weak, geneList)\ntmp3 <- PerformanceNET(PredictedNET = Network_rntiref_cyt,ValidatedNET = Cancer_IPANet$complete, geneList)\nPerformance_matrix_BRCA <- rbind(tmp1, tmp2,tmp3)\nrownames(Performance_matrix_BRCA) <- c(\"strong\",\"weak\",\"complete\")\n\nLatexPrintTableforPresentation(Performance_matrix_BRCA, rowsForPage=nrow(Performance_matrix_BRCA),TableTitle=\"p\" , LabelTitle=\"p\",withrows= T )\n\n\n\n\n\n\n\n# old script\nload(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_Networks/BRCA_IPANet.RData\")\ntfList <- unique(Cancer_IPANet$complete$from)\n\nload(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_Networks/BRCA_IPANet.RData\")\nsource('/storage/ocfs2_vol1/PUBLIC/LA_functions/DIFF_network_functions24.R')\nload(\"/storage/ocfs2_vol1/PUBLIC/LA_functions/ListofTumor.RData\")\nListofTumor <- as.vector(sort(ListofTumor))\nload(\"/storage/ocfs2_vol1/PUBLIC/LA_functions/geneList.RData\")\n\nload(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_Networks/RTN_Network/rtniDpi.RData\")\n\nNetwork_rntiDpi <- t(rtniDpi@results$tn.dpi)\nNetwork_rntiDpi_cyt <- ConvertCor_to_Cytoscape_onlyNet(Network_rntiDpi,outPrint=T)\n\nNetwork_rntiRef <- t(rtniDpi@results$tn.ref)\nNetwork_rntiRef_cyt <- ConvertCor_to_Cytoscape_onlyNet(Network_rntiRef,outPrint=T)\n\nPerformanceNET(PredictedNET = Network_rntiDpi_cyt,ValidatedNET = Cancer_IPANet$strong, geneList)\nPerformanceNET(PredictedNET = Network_rntiDpi_cyt,ValidatedNET = Cancer_IPANet$weak, geneList)\nPerformanceNET(PredictedNET = Network_rntiDpi_cyt,ValidatedNET = Cancer_IPANet$complete, geneList)\n\nPerformanceNET(PredictedNET = Network_rntiRef_cyt,ValidatedNET = Cancer_IPANet$strong, geneList)\nPerformanceNET(PredictedNET = Network_rntiRef_cyt,ValidatedNET = Cancer_IPANet$weak, geneList)\nPerformanceNET(PredictedNET = Network_rntiRef_cyt,ValidatedNET = Cancer_IPANet$complete, geneList)\n\n\n\n# common pairs between MI and cor \n\n\nload(\"/storage/ocfs2_vol1/PUBLIC/TCGA_panCancer/TCGA_Networks/BRCA_knnNet.RData\")\nCancer_knnNet$Net <- cbind(Pairs = paste( Cancer_knnNet$Net[,\"from\"], Cancer_knnNet$Net[,\"to\"], sep=\",\"),Cancer_knnNet$Net)\n\nCommonMI_cor_net <- Cancer_knnNet$Net [ Cancer_knnNet$Net$Pairs %in% Network_rntiDpi_cyt$Pairs,]\n\nPerformanceNET(PredictedNET = CommonMI_cor_net,ValidatedNET = Cancer_IPANet$strong, geneList)\nPerformanceNET(PredictedNET = CommonMI_cor_net,ValidatedNET = Cancer_IPANet$weak, geneList)\nPerformanceNET(PredictedNET = CommonMI_cor_net,ValidatedNET = Cancer_IPANet$complete, geneList)\n\n\n\n\n\n\n@\n\n<< Network with package rsgcc , eval=FALSE, echo = FALSE >>=\ninstall.packages(\"cairoDevice\")\ninstall.packages(\"rsgcc\")\nlibrary(rsgcc)\n\n\n\n\n@\n\n\\end{document}\n\n\n",
    "created" : 1429880467978.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "10|56|54|1|\n112|33|157|1|\n159|43|163|1|\n171|62|229|1|\n231|33|303|1|\n305|35|317|1|\n319|45|358|1|\n386|54|432|1|\n434|58|472|1|\n474|58|597|1|\n599|60|607|1|\n",
    "hash" : "3246012213",
    "id" : "FD139FF6",
    "lastKnownWriteTime" : 1429884048,
    "path" : "~/Downloads/2014_08_08_NetworkTCGA_new.Rnw",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "sweave"
}